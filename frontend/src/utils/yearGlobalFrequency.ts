/**
 * Глобальные частоты годов выпуска фильмов из TMDb (в процентах от общего количества фильмов).
 * Данные получены через TMDb API discover endpoint.
 * 
 * Значения представляют долю фильмов каждого года от общего количества фильмов в TMDb.
 * Например, 2024 год составляет ~5.28% всех фильмов в TMDb.
 */
export const YEAR_GLOBAL_FREQUENCY: Record<string, number> = {
  '1900': 0.04375133881117609,
  '1901': 0.02960540940340553,
  '1902': 0.02485641881651113,
  '1903': 0.03698150116602875,
  '1904': 0.030514790579619356,
  '1905': 0.033040849402435526,
  '1906': 0.03485961175486317,
  '1907': 0.03576899293107699,
  '1908': 0.05052117645632343,
  '1909': 0.057796225866034015,
  '1910': 0.08942248232769247,
  '1911': 0.11256118114468862,
  '1912': 0.15883857877868088,
  '1913': 0.16288027289518675,
  '1914': 0.16843760230538232,
  '1915': 0.1763189058325688,
  '1916': 0.1795522611257735,
  '1917': 0.17136783053984908,
  '1918': 0.15318020701557267,
  '1919': 0.15701981642625323,
  '1920': 0.16096046818984644,
  '1921': 0.15146248701605763,
  '1922': 0.14519786113547356,
  '1923': 0.13650821878498592,
  '1924': 0.14560203054712414,
  '1925': 0.15964691760198205,
  '1926': 0.17652099053839407,
  '1927': 0.1781376681849964,
  '1928': 0.176824117597132,
  '1929': 0.1804616423019873,
  '1930': 0.19723467288548668,
  '1931': 0.18783773406461052,
  '1932': 0.19086900465198992,
  '1933': 0.19198047053402906,
  '1934': 0.19996281641412816,
  '1935': 0.2101680940583055,
  '1936': 0.21057226346995606,
  '1937': 0.21815043993840458,
  '1938': 0.21845356699714252,
  '1939': 0.20461076464810987,
  '1940': 0.19935656229665227,
  '1941': 0.19390027523936934,
  '1942': 0.1989523928850017,
  '1943': 0.18329082818354142,
  '1944': 0.16378965407140056,
  '1945': 0.16328444230683734,
  '1946': 0.1677303058349938,
  '1947': 0.17611682112674348,
  '1948': 0.19379923288645667,
  '1949': 0.21784731287966663,
  '1950': 0.22764842111219338,
  '1951': 0.24037975757918692,
  '1952': 0.2382578681680213,
  '1953': 0.2527069246345298,
  '1954': 0.2642257528665716,
  '1955': 0.26614555757191183,
  '1956': 0.28190816462628476,
  '1957': 0.29756972932774506,
  '1958': 0.31121044697095235,
  '1959': 0.31484797167580764,
  '1960': 0.33525852696416225,
  '1961': 0.3497075834306708,
  '1962': 0.35829618342824576,
  '1963': 0.3584982681340711,
  '1964': 0.3932568375360216,
  '1965': 0.42397371282146623,
  '1966': 0.4342800328185562,
  '1967': 0.47500010104235296,
  '1968': 0.5010690280938158,
  '1969': 0.5252181504399384,
  '1970': 0.5364338516132422,
  '1971': 0.5264306586748901,
  '1972': 0.5515902045501392,
  '1973': 0.5400713763180974,
  '1974': 0.5503776963151874,
  '1975': 0.5423953504350884,
  '1976': 0.5515902045501392,
  '1977': 0.5259254469103269,
  '1978': 0.5710913786622801,
  '1979': 0.5846310539525748,
  '1980': 0.5819029104239333,
  '1981': 0.5667465574870362,
  '1982': 0.5967561363020923,
  '1983': 0.5993832374778212,
  '1984': 0.6118114468860768,
  '1985': 0.6158531410025827,
  '1986': 0.6335355527622958,
  '1987': 0.6820358821603663,
  '1988': 0.6895130162759022,
  '1989': 0.7191184256793077,
  '1990': 0.7097214868584316,
  '1991': 0.7141673503865881,
  '1992': 0.7067912586239647,
  '1993': 0.6956765998035737,
  '1994': 0.6872900845118239,
  '1995': 0.7064881315652268,
  '1996': 0.7032547762720223,
  '1997': 0.757110350374463,
  '1998': 0.7697406444885437,
  '1999': 0.8302650138832193,
  '2000': 0.840066122115746,
  '2001': 0.9100884726842104,
  '2002': 0.9943577950133577,
  '2003': 1.108737738510474,
  '2004': 1.2133165737750635,
  '2005': 1.3268881784488786,
  '2006': 1.4677412184091083,
  '2007': 1.520182199570772,
  '2008': 1.607179665428561,
  '2009': 1.6998355030494583,
  '2010': 1.7662203289130671,
  '2011': 1.9148536300475707,
  '2012': 2.087029799410721,
  '2013': 2.3386252581632117,
  '2014': 2.5063555639982056,
  '2015': 2.633163716903577,
  '2016': 2.782302229802644,
  '2017': 3.1253410179410803,
  '2018': 3.355212370817352,
  '2019': 3.701282429543167,
  '2020': 3.69259278719268,
  '2021': 4.029164864744706,
  '2022': 4.249437194094276,
  '2023': 4.878931052740067,
  '2024': 5.282292125567353,
  '2025': 5.0377696315187475,
  '2026': 0.6173687762962723,
}

/**
 * Получить глобальную частоту года (в процентах).
 * 
 * @param year - Год выпуска фильма
 * @returns Глобальная частота года в процентах (0-100), или null если год не найден
 */
export function getYearGlobalFrequency(year: string | number | null | undefined): number | null {
  if (year === null || year === undefined) return null
  const yearStr = String(year).trim()
  return YEAR_GLOBAL_FREQUENCY[yearStr] ?? null
}

/**
 * Создать Map с глобальными частотами годов для использования в расчётах.
 * 
 * @returns Map: год (строка) → глобальная частота (%)
 */
export function createYearGlobalFrequencyMap(): Map<string, number> {
  const map = new Map<string, number>()
  for (const [year, frequency] of Object.entries(YEAR_GLOBAL_FREQUENCY)) {
    map.set(year, frequency)
  }
  return map
}

/**
 * Вычислить глобальные частоты десятилетий на основе данных по годам.
 * Десятилетие рассчитывается как Math.floor(year / 10) * 10 (например, 1920, 1930, 1940).
 * 
 * @returns Map: десятилетие (строка, например "1920") → глобальная частота (%)
 */
export function createDecadeGlobalFrequencyMap(): Map<string, number> {
  const decadeMap = new Map<string, number>()
  
  // Суммируем частоты всех годов в каждом десятилетии
  for (const [yearStr, frequency] of Object.entries(YEAR_GLOBAL_FREQUENCY)) {
    const year = parseInt(yearStr, 10)
    if (isNaN(year)) continue
    
    const decade = Math.floor(year / 10) * 10
    const decadeStr = String(decade)
    
    const currentFreq = decadeMap.get(decadeStr) || 0
    decadeMap.set(decadeStr, currentFreq + frequency)
  }
  
  return decadeMap
}
